<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ตรวจสอบสิทธิ PPFS 2569</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-50">

<div class="container max-w-4xl mx-auto py-8 px-4 sm:py-16">
    <div class="text-center mb-8 sm:mb-12">
        <h1 class="text-3xl sm:text-5xl font-extrabold text-gray-800 mb-3 sm:mb-4">
           ตรวจสอบสิทธิ PPFS
        </h1>
        <p class="text-base sm:text-xl text-gray-500 max-w-2xl mx-auto">
            สปสช. 2569 - บริการส่งเสริมสุขภาพและป้องกันโรค
        </p>
    </div>

    <div class="p-6 sm:p-10 shadow-2xl rounded-2xl bg-white border border-gray-200">
        <div class="space-y-6 sm:space-y-8">
            <div class="bg-blue-50 border border-blue-200 rounded-xl p-4 sm:p-6">
                <p class="text-sm sm:text-base text-blue-800">
                    กรุณาป้อนข้อมูลเพื่อตรวจสอบรายการบริการส่งเสริมสุขภาพและป้องกันโรค (PPFS) ที่ได้รับสิทธิ์โดยอัตโนมัติ
                </p>
            </div>

            <div class="grid sm:grid-cols-2 gap-6">
                <div class="space-y-3">
                    <label for="age-input" class="text-base font-semibold text-gray-700">
                        อายุ (ปี)
                    </label>
                    <input
                        id="age-input"
                        type="number"
                        min="0"
                        max="120"
                        placeholder="ตัวเลข เช่น 35"
                        oninput="checkEligibility()"
                        class="w-full h-12 text-base border-2 border-gray-300 rounded-lg px-4 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"
                    />
                </div>

                <div class="space-y-3">
                    <label class="text-base font-semibold text-gray-700">เพศ</label>
                    <div class="flex gap-3 h-12">
                        <button
                            type="button"
                            id="gender-btn-1"
                            onclick="selectGender('1')"
                            class="gender-btn flex-1 text-base font-semibold transition-all rounded-lg bg-blue-500 text-white shadow-md">
                            ชาย
                        </button>
                        <button
                            type="button"
                            id="gender-btn-2"
                            onclick="selectGender('2')"
                            class="gender-btn flex-1 text-base font-semibold transition-all rounded-lg bg-white border border-gray-300 text-gray-600 hover:bg-pink-50 hover:border-pink-500">
                            หญิง
                        </button>
                    </div>
                </div>
            </div>

            <!-- ตั้งครรภ์/ประกันสังคม (แสดงในบรรทัดเดียวกัน) -->
            <div class="space-y-3">
                <label class="text-base font-semibold text-gray-700">ตั้งครรภ์/ประกันสังคม</label>
                <div class="flex flex-wrap gap-3">
                    <button
                        type="button"
                        id="pregnancy-btn"
                        onclick="togglePregnancy()"
                        class="pregnancy-btn px-4 py-2 text-base font-semibold transition-all rounded-lg bg-white border border-gray-300 text-gray-600 hover:bg-green-50 hover:border-green-500">
                        ตั้งครรภ์
                    </button>
                    <button
                        type="button"
                        id="social-security-btn"
                        onclick="toggleSocialSecurity()"
                        class="social-security-btn px-4 py-2 text-base font-semibold transition-all rounded-lg bg-white border border-gray-300 text-gray-600 hover:bg-purple-50 hover:border-purple-500">
                        ประกันสังคม
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="results-output" class="mt-6 sm:mt-8" style="display: none;"></div>

    <div class="mt-8 sm:mt-12 text-center text-xs sm:text-sm text-gray-400">
        <p>ข้อมูลจาก สปสช. (สำนักงานหลักประกันสุขภาพแห่งชาติ) ปี พ.ศ. 2569</p>
    </div>
</div>

<script>
let selectedGender = '1'; // Default to Male
let isPregnant = false;
let hasSocialSecurity = false;

function selectGender(gender) {
    selectedGender = gender;
    const maleBtn = document.getElementById('gender-btn-1');
    const femaleBtn = document.getElementById('gender-btn-2');
    
    if (gender === '1') {
        maleBtn.className = 'gender-btn flex-1 text-base font-semibold transition-all rounded-lg bg-blue-500 text-white shadow-md';
        femaleBtn.className = 'gender-btn flex-1 text-base font-semibold transition-all rounded-lg bg-white border border-gray-300 text-gray-600 hover:bg-pink-50 hover:border-pink-500';
        // ถ้าเลือกเพศชาย ให้ยกเลิกการตั้งครรภ์
        if (isPregnant) {
            isPregnant = false;
            resetPregnancyButton();
        }
    } else {
        maleBtn.className = 'gender-btn flex-1 text-base font-semibold transition-all rounded-lg bg-white border border-gray-300 text-gray-600 hover:bg-blue-50 hover:border-blue-500';
        femaleBtn.className = 'gender-btn flex-1 text-base font-semibold transition-all rounded-lg bg-pink-500 text-white shadow-md';
    }

    // Trigger check on gender change
    checkEligibility();
}

function togglePregnancy() {
    // ถ้าคลิกตั้งครรภ์ ให้เลือกเพศหญิงอัตโนมัติ
    if (!isPregnant) {
        selectGender('2');
    }
    
    isPregnant = !isPregnant;
    const pregnancyBtn = document.getElementById('pregnancy-btn');
    
    if (isPregnant) {
        pregnancyBtn.className = 'pregnancy-btn px-4 py-2 text-base font-semibold transition-all rounded-lg bg-green-500 text-white shadow-md';
    } else {
        pregnancyBtn.className = 'pregnancy-btn px-4 py-2 text-base font-semibold transition-all rounded-lg bg-white border border-gray-300 text-gray-600 hover:bg-green-50 hover:border-green-500';
    }
    
    checkEligibility();
}

function toggleSocialSecurity() {
    hasSocialSecurity = !hasSocialSecurity;
    const socialSecurityBtn = document.getElementById('social-security-btn');
    
    if (hasSocialSecurity) {
        socialSecurityBtn.className = 'social-security-btn px-4 py-2 text-base font-semibold transition-all rounded-lg bg-purple-500 text-white shadow-md';
    } else {
        socialSecurityBtn.className = 'social-security-btn px-4 py-2 text-base font-semibold transition-all rounded-lg bg-white border border-gray-300 text-gray-600 hover:bg-purple-50 hover:border-purple-500';
    }
    
    checkEligibility();
}

function resetPregnancyButton() {
    const pregnancyBtn = document.getElementById('pregnancy-btn');
    pregnancyBtn.className = 'pregnancy-btn px-4 py-2 text-base font-semibold transition-all rounded-lg bg-white border border-gray-300 text-gray-600 hover:bg-green-50 hover:border-green-500';
}

// ข้อมูลบริการ PPFS ตามที่ให้มา (ย่อเพื่อให้โค้ดสั้นลง)
const ppfsServices = [
    // บริการตั้งครรภ์
    {
        code: "PPFS01",
        name: "บริการฝากครรภ์",
        minAge: 13,
        maxAge: 59,
        gender: "2",
        category: "ตั้งครรภ์",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> หญิงไทยตั้งครรภ์ ทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS02",
        name: "บริการป้องกันและควบคุมโรคโลหิตจางธาลัสซีเมียในหญิงตั้งครรภ์",
        minAge: 13,
        maxAge: 59,
        gender: "1,2",
        category: "ตั้งครรภ์",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> หญิงตั้งครรภ์ และสามีหรือคู่ของหญิงตั้งครรภ์ คนไทย ทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS03",
        name: "บริการคัดกรองธาลัสซีเมียในสามีหรือคู่ของหญิงตั้งครรภ์และบริการคัดกรองโรคซิฟิลิส",
        minAge: 13,
        maxAge: 59,
        gender: "1,2",
        category: "ตั้งครรภ์",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> บริการคัดกรองธาลัสซีเมีย: สามีหรือคู่ของหญิงตั้งครรภ์</p></div>`
    },
    {
        code: "PPFS04",
        name: "บริการป้องกันและควบคุมกลุ่มอาการดาวน์ในหญิงตั้งครรภ์",
        minAge: 13,
        maxAge: 59,
        gender: "2",
        category: "ตั้งครรภ์",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> 1. หญิงตั้งครรภ์ ที่เป็นคนไทยทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS05",
        name: "การตรวจหลังคลอด",
        minAge: 13,
        maxAge: 59,
        gender: "2",
        category: "ตั้งครรภ์",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> หญิงหลังคลอดคนไทย ทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS06",
        name: "บริการการทดสอบการตั้งครรภ์",
        minAge: 13,
        maxAge: 59,
        gender: "2",
        category: "ตั้งครรภ์",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> หญิงวัยเจริญพันธุ์ที่สงสัยตั้งครรภ์หรือประจำเดือนไม่มาตามกำหนดทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS17",
        name: "บริการป้องกันการยุติการตั้งครรภ์ที่ไม่ปลอดภัย",
        minAge: 13,
        maxAge: 59,
        gender: "2",
        category: "ตั้งครรภ์",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> หญิงไทยทุกอายุ ทุกสิทธิการรักษาพยาบาล ที่จำเป็นต้องยุติการตั้งครรภ์</p></div>`
    },
    
    // บริการทั่วไป
    {
        code: "PPFS07",
        name: "บริการป้องกันและควบคุมภาวะพร่องฮอร์โมนไทรอยด์ (TSH)",
        minAge: 0,
        maxAge: 0,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> เด็กไทยแรกเกิดทุกคน ทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS08",
        name: "บริการตรวจคัดกรองผู้ป่วยโรคพันธุกรรมเมตาบอลิกด้วยเครื่อง Tandem mass spectrometry (TMS)",
        minAge: 0,
        maxAge: 0,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> เด็กไทยแรกเกิดทุกคน ทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS09",
        name: "บริการแว่นตาเด็กที่มีสายตาผิดปกติ",
        minAge: 3,
        maxAge: 12,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> เด็กไทยทุกคน อายุ 3 – 12 ปี</p></div>`
    },
    {
        code: "PPFS10",
        name: "บริการคัดกรองรอยโรคเสี่ยงมะเร็งและมะเร็งช่องปาก (CA Oral Screening)",
        minAge: 40,
        maxAge: 120,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ประชาชนไทยทุกคน ที่มีอายุ 40 ปีขึ้นไป ทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS11",
        name: "บริการการตรวจคัดกรองมะเร็งปากมดลูก",
        minAge: 15,
        maxAge: 59,
        gender: "2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> หญิงไทยอายุ 30 - 59 ปี ทุกคน หรือหญิงไทยอายุ 15 - 29 ปี ที่มีความเสี่ยงสูง</p></div>`
    },
    {
        code: "PPFS12",
        name: "บริการตรวจยีน BRCA1/BRCA2 ในกลุ่มผู้ป่วยมะเร็งเต้านมที่มีความเสี่ยงสูงและญาติสายตรงที่มี ประวัติครอบครัวตรวจพบยีนกลายพันธุ์",
        minAge: 18,
        maxAge: 120,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> กลุ่มผู้ป่วยมะเร็งเต้านมที่มีความเสี่ยงสูงและญาติสายตรงที่มีประวัติครอบครัวตรวจพบยีนกลายพันธุ์</p></div>`
    },
    {
        code: "PPFS13",
        name: "บริการตรวจคัดกรองมะเร็งลำไส้ใหญ่และลำไส้ตรง (Fit test)",
        minAge: 50,
        maxAge: 70,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ประชากรไทย กลุ่มอายุระหว่าง 50 - 70 ปี ทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS14",
        name: "บริการคัดกรองโลหิตจางจากการขาดธาตุเหล็ก",
        minAge: 13,
        maxAge: 24,
        gender: "2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> เขต 1-12 : หญิงไทยทุกคน อายุ 13 - 24 ปี</p></div>`
    },
    {
        code: "PPFS15",
        name: "บริการยาเม็ดเสริมธาตุเหล็ก",
        minAge: 13,
        maxAge: 45,
        gender: "2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> เขต 1-12 : หญิงไทยทุกคน อายุ 13 - 45 ปี</p></div>`
    },
    {
        code: "PPFS16",
        name: "บริการเคลือบฟลูออไรด์",
        minAge: 25,
        maxAge: 59,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> 1. ผู้มีอายุ 25 - 59 ปี กลุ่มเสี่ยง ไม่เกิน 2 ครั้ง/ปี</p></div>`
    },
    {
        code: "PPFS18",
        name: "บริการตรวจคัดกรองและค้นหาวัณโรคในกลุ่มเสี่ยงสูง",
        minAge: 0,
        maxAge: 120,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ที่มีความเสี่ยงสูงต่อการติดเชื้อวัณโรค 7 กลุ่มเป้าหมาย</p></div>`
    },
    {
        code: "PPFS19",
        name: "การตรวจคัดกรองโรคไวรัสตับอักเสบ บี",
        minAge: 34,
        maxAge: 120,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ประชากรไทย ทุกสิทธิการรักษาพยาบาล ที่เกิดก่อนปี 2535</p></div>`
    },
    {
        code: "PPFS20",
        name: "บริการตรวจคัดกรองไวรัสตับอักเสบ ซี",
        minAge: 34,
        maxAge: 120,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> 1. ประชากรไทยที่เกิดก่อนปี 2535 ทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS21",
        name: "บริการวางแผนครอบครัวและการป้องกันการตั้งครรภ์ไม่พึงประสงค์",
        minAge: 13,
        maxAge: 59,
        gender: "2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> หญิงไทยวัยเจริญพันธุ์ ทุกสิทธิการรักษาพยาบาล</p></div>`
    },
    {
        code: "PPFS22",
        name: "บริการตรวจคัดกรองพยาธิใบไม้ตับด้วยการตรวจปัสสาวะ Urine OV-Rapid Diagnosis Test (OV-RDT)",
        minAge: 15,
        maxAge: 120,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ประชาชนไทยทุกสิทธิ อายุ 15 ปีขึ้นไป ที่มีประวัติเสี่ยง</p></div>`
    },
    {
        code: "PPFS23",
        name: "บริการตรวจคัดกรองมะเร็งเต้านมด้วยเครื่องแมมโมแกรมและอัลตราซาวด์",
        minAge: 40,
        maxAge: 120,
        gender: "2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> หญิงไทยทุกสิทธิ อายุ 40 ปีขึ้นไป ที่มีประวัติญาติสายตรงเป็นมะเร็งเต้านม</p></div>`
    },
    {
        code: "PPFS24",
        name: "บริการคัดกรองเบาหวานและไขมันในเลือด",
        minAge: 35,
        maxAge: 70,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> 1. ผู้มีอายุ 35-59 ปี ที่มีความเสี่ยงต่อการเกิดโรคเบาหวาน</p></div>`
    },
    {
        code: "PPFS25",
        name: "ค่าบริการให้วัคซีนป้องกันโรค",
        minAge: 0,
        maxAge: 120,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ทุกกลุ่มอายุ</p></div>`
    },
    {
        code: "PPFS26",
        name: "บริการคัดกรองวัณโรคระยะแฝง (Latent TB Infection)",
        minAge: 12,
        maxAge: 59,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> กลุ่มอายุ 12-59 ปี</p></div>`
    },
    {
        code: "PPFS29",
        name: "บริการศูนย์ให้คำปรึกษาสุขภาพจิต",
        minAge: 12,
        maxAge: 120,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> เป็นการให้บริการแก่ ผู้รับบริการที่มีอายุ 12 ปีขึ้นไป</p></div>`
    },
    {
        code: "PPFS30",
        name: "บริการฮอร์โมนเพื่อการยืนยันเพศสภาพ",
        minAge: 13,
        maxAge: 120,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> บุคคลผู้มีความต้องการยืนยันเพศสภาพ จ่ายตาม Protocol 1-4</p></div>`
    },
    {
        code: "PPFS31",
        name: "การตรวจคัดกรองโรคกระดูกพรุนในสตรีวัยหมดประจำเดือน",
        minAge: 60,
        maxAge: 120,
        gender: "2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้หญิงอายุ 60 ปี ขึ้นไป ทุก 5 ปี ด้วยเครื่องมือประเมินความเสี่ยงFRAX®</p></div>`
    },
    {
        code: "PPFS33",
        name: "บริการตรวจหาการติดเชื้อเอชไอวีด้วยตนเอง (HIV self-screening Test : HIVSST)",
        minAge: 0,
        maxAge: 120,
        gender: "1,2",
        category: "ทั่วไป",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ประชาชนไทยทุกคน</p></div>`
    },
    
    // บริการประกันสังคม
    {
        code: "PPSSO01",
        name: "การคัดกรองการได้ยิน Finger Rub Test",
        minAge: 15,
        maxAge: 120,
        gender: "1,2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตน</p></div>`
    },
    {
        code: "PPSSO02",
        name: "การตรวจเต้านมโดยแพทย์หรือบุคลากรสาธารณสุข",
        minAge: 30,
        maxAge: 120,
        gender: "2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตนเพศหญิง</p></div>`
    },
    {
        code: "PPSSO03",
        name: "การตรวจตาโดยความดูแลของจักษุแพทย์",
        minAge: 40,
        maxAge: 120,
        gender: "1,2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตน</p></div>`
    },
    {
        code: "PPSSO04",
        name: "การตรวจความสมบูรณ์ของเม็ดเลือด CBC",
        minAge: 15,
        maxAge: 120,
        gender: "1,2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตน</p></div>`
    },
    {
        code: "PPSSO05",
        name: "การตรวจปัสสาวะ UA",
        minAge: 35,
        maxAge: 120,
        gender: "1,2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตน</p></div>`
    },
    {
        code: "PPSSO06",
        name: "การตรวจน้ำตาลในเลือด FBS (Fasting Blood Sugar)",
        minAge: 35,
        maxAge: 120,
        gender: "1,2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตน</p></div>`
    },
    {
        code: "PPSSO07",
        name: "ตรวจการทำงานของไต Cr และ eGFR",
        minAge: 35,
        maxAge: 120,
        gender: "1,2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตน</p></div>`
    },
    {
        code: "PPSSO08",
        name: "การตรวจไขมันในเส้นเลือดชนิด Total & HDL Cholesterol",
        minAge: 20,
        maxAge: 120,
        gender: "1,2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตน</p></div>`
    },
    {
        code: "PPSSO09",
        name: "การตรวจเชื้อไวรัสตับอักเสบ HBsAg",
        minAge: 34,
        maxAge: 120,
        gender: "1,2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตน</p></div>`
    },
    {
        code: "PPSSO10",
        name: "การตรวจมะเร็งปากมดลูก Pap Smear",
        minAge: 30,
        maxAge: 120,
        gender: "2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตนเพศหญิง</p></div>`
    },
    {
        code: "PPSSO11",
        name: "การตรวจมะเร็งปากมดลูกวิธี Via",
        minAge: 30,
        maxAge: 54,
        gender: "2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตนเพศหญิง</p></div>`
    },
    {
        code: "PPSSO12",
        name: "การตรวจมะเร็งปากมดลูก HPV DNA Test",
        minAge: 30,
        maxAge: 120,
        gender: "2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตนเพศหญิง</p></div>`
    },
    {
        code: "PPSSO13",
        name: "การตรวจคัดกรองมะเร็งลำไส้ใหญ่และลำไส้ตรง",
        minAge: 50,
        maxAge: 120,
        gender: "1,2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตน</p></div>`
    },
    {
        code: "PPSSO14",
        name: "การถ่ายภาพรังสีทรวงอก (Chest X-ray)",
        minAge: 15,
        maxAge: 120,
        gender: "1,2",
        category: "ประกันสังคม",
        details: `<div class='space-y-2'><p><strong>กลุ่มเป้าหมาย:</strong> ผู้ประกันตน</p></div>`
    }
];

// ฟังก์ชันหลักสำหรับตรวจสอบสิทธิ
function checkEligibility() {
    const ageInput = document.getElementById('age-input');
    const resultsOutput = document.getElementById('results-output');
    resultsOutput.style.display = 'block';

    const numericalAge = parseInt(ageInput.value);
    const genderDisplay = selectedGender === '1' ? 'ชาย' : 'หญิง';

    // 1. Input Validation
    if (isNaN(numericalAge) || numericalAge < 0 || numericalAge > 120) {
        resultsOutput.innerHTML = `
            <div class="p-4 sm:p-6 bg-red-50 border-2 border-red-300 rounded-xl shadow-inner">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-red-200 flex items-center justify-center flex-shrink-0">
                        <span class="text-2xl">⚠️</span>
                    </div>
                    <h3 class="text-xl sm:text-2xl font-bold text-red-700"> ข้อมูลไม่ถูกต้อง </h3>
                </div>
                <p class="text-red-800/80 mt-2 pl-13">กรุณาป้อนอายุเป็นตัวเลขที่ถูกต้องในช่วง 0 ถึง 120 ปี</p>
            </div>`;
        return;
    }

    // 2. ตรวจสอบสิทธิในแต่ละบริการ
    const eligibleServices = ppfsServices.filter(service => {
        // ตรวจสอบช่วงอายุ
        let ageEligible = false;
        if (service.minAge === 0 && service.maxAge === 0) {
            // กรณีอายุ 0 ปี (แรกเกิด)
            ageEligible = numericalAge === 0;
        } else {
            ageEligible = numericalAge >= service.minAge && numericalAge <= service.maxAge;
        }
        
        // ตรวจสอบเพศ
        const genderEligible = service.gender.includes(selectedGender);
        
        // ตรวจสอบเงื่อนไขพิเศษ
        let specialConditionEligible = true;
        
        // สำหรับบริการตั้งครรภ์ ต้องเลือก "ตั้งครรภ์"
        if (service.category === "ตั้งครรภ์") {
            specialConditionEligible = isPregnant;
        }
        
        // สำหรับบริการประกันสังคม ต้องเลือก "ประกันสังคม"
        if (service.category === "ประกันสังคม") {
            specialConditionEligible = hasSocialSecurity;
        }
        
        return ageEligible && genderEligible && specialConditionEligible;
    });

    // 3. แสดงผล
    if (eligibleServices.length > 0) {
        // จัดกลุ่มบริการตามประเภท
        const generalServices = eligibleServices.filter(service => service.category === "ทั่วไป");
        const socialSecurityServices = eligibleServices.filter(service => service.category === "ประกันสังคม");
        const pregnancyServices = eligibleServices.filter(service => service.category === "ตั้งครรภ์");

        // สร้าง HTML สำหรับบริการที่ได้รับสิทธิ
        const createServiceListHTML = (services, title, category) => {
            if (services.length === 0) return '';
            
            const serviceListHTML = services.map(service => {
                return `
                    <div class="bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden">
                        <button onclick="toggleAccordion('${service.code}')" class="w-full text-left p-3 sm:p-4 font-semibold text-gray-800 hover:bg-gray-50 flex justify-between items-center transition-colors">
                            <span>${service.name}</span>
                            <i id="icon-${service.code}" class="fa-solid fa-chevron-down transition-transform duration-300"></i>
                        </button>
                        <div id="details-${service.code}" class="accordion-content hidden px-3 sm:px-4 pb-4 text-gray-600 text-sm space-y-2">
                            ${service.details}
                        </div>
                    </div>
                `;
            }).join('');

            return `
                <div class="mb-6">
                    <button onclick="toggleCategory('${category}')" class="w-full text-left flex justify-between items-center p-4 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl border border-blue-200 hover:bg-blue-100 transition-colors">
                        <h4 class="text-lg font-bold text-gray-800">${title} (${services.length} รายการ)</h4>
                        <i id="category-icon-${category}" class="fa-solid fa-chevron-down transition-transform duration-300"></i>
                    </button>
                    <div id="category-content-${category}" class="mt-3 space-y-3">
                        ${serviceListHTML}
                    </div>
                </div>
            `;
        };

        let resultsHTML = `
            <div class="p-6 sm:p-8 shadow-2xl rounded-2xl bg-white border border-gray-200">
                <h3 class="text-xl sm:text-2xl font-bold text-gray-800">✅ สรุปสิทธิ PPFS </h3>
                <p class="text-gray-700 font-semibold mb-3 mt-1">สำหรับผู้ที่มีอายุ ${numericalAge} ปี (เพศ ${genderDisplay})</p>
                ${hasSocialSecurity ? '<p class="text-purple-600 font-semibold mb-2">✓ สถานะ: ประกันสังคม</p>' : ''}
                ${isPregnant ? '<p class="text-green-600 font-semibold mb-2">✓ สถานะ: ตั้งครรภ์</p>' : ''}
                <p class="text-gray-700 font-semibold mb-4">พบรายการบริการส่งเสริมสุขภาพและป้องกันโรคที่ได้รับสิทธิ์: <span class="text-green-600">${eligibleServices.length} รายการ</span></p>
                
                ${createServiceListHTML(generalServices, 'บริการทั่วไป', 'general')}
                ${createServiceListHTML(socialSecurityServices, 'บริการประกันสังคม', 'social')}
                ${createServiceListHTML(pregnancyServices, 'บริการหญิงตั้งครรภ์', 'pregnancy')}
                
                <p class="text-sm text-gray-500 mt-4">**คลิกที่กลุ่มบริการเพื่อยุบ/ขยาย และคลิกที่รายการเพื่อดูรายละเอียดเพิ่มเติม</p>
            </div>
        `;

        resultsOutput.innerHTML = resultsHTML;
    } else {
        resultsOutput.innerHTML = `
            <div class="p-6 sm:p-8 shadow-2xl rounded-2xl bg-white border border-gray-200">
                <h3 class="text-xl sm:text-2xl font-bold text-gray-800">❌ ไม่พบสิทธิ</h3>
                <p class="text-red-700 mt-2">ไม่พบรายการบริการ PPFS สำหรับข้อมูลที่คุณป้อน</p>
            </div>
        `;
    }
}

// ฟังก์ชันสำหรับ Accordion เปิด-ปิดรายละเอียด
function toggleAccordion(serviceCode) {
    const detailsDiv = document.getElementById(`details-${serviceCode}`);
    const icon = document.getElementById(`icon-${serviceCode}`);
    if (detailsDiv && icon) {
        const isHidden = detailsDiv.classList.contains('hidden');
        detailsDiv.classList.toggle('hidden');
        icon.classList.toggle('rotate-180', !isHidden);
    }
}

// ฟังก์ชันสำหรับยุบ/ขยายกลุ่มบริการ
function toggleCategory(category) {
    const contentDiv = document.getElementById(`category-content-${category}`);
    const icon = document.getElementById(`category-icon-${category}`);
    if (contentDiv && icon) {
        const isHidden = contentDiv.classList.contains('hidden');
        contentDiv.classList.toggle('hidden');
        icon.classList.toggle('rotate-180', !isHidden);
    }
}

// Initialize gender selection on load
document.addEventListener('DOMContentLoaded', () => {
    selectGender('1'); // Set default to Male on page load
    document.getElementById('results-output').style.display = 'none'; // Ensure results are hidden on load
});
</script>
</body>
</html>
